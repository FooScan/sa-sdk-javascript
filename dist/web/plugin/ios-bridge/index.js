(window.SensorsDataWebJSSDKPlugin=window.SensorsDataWebJSSDKPlugin||{}).IOSBridge=function(){"use strict";function e(e,i,a){var r=e.init;return i&&(e.name=i),e.init=function(i,s){function n(){r.call(e,i,s)}return i.readyState&&i.readyState.state>=3||!i.on?n():void i.on(a,n)},e}function i(){if(s=window.SensorsData_iOS_JS_Bridge&&window.SensorsData_iOS_JS_Bridge.sensorsdata_app_server_url,n=function(){return window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.sensorsdataNativeTracker},t&&!t.bridge.activeBridge&&n()&&n().postMessage){if(t.bridge.activeBridge=_,t.para.app_js_bridge&&!t.para.app_js_bridge.is_mui&&(t.bridge.is_verify_success=s&&t.bridge.validateAppUrl(s)),t.bridge.bridge_info={touch_app_bridge:!0,platform:"ios",verify_success:t.bridge.is_verify_success?"success":"fail",support_two_way_call:!0},!t.para.app_js_bridge)return void o("app_js_bridge is not configured, data will not be sent by iOS bridge.");t.registerInterceptor("sendStage",{send:{priority:0,entry:a}}),o("IOS bridge inits succeed.")}}function a(e,i){if(t.para.app_js_bridge.is_mui)return e;var a=e.callback;return t.bridge.is_verify_success?(n()&&n().postMessage(JSON.stringify({callType:"app_h5_track",data:d.extend({server_url:t.para.server_url},e.data)})),d.isFunction(a)&&a(),i.cancellationToken.cancel(),e):t.para.app_js_bridge.is_send?(t.debug.apph5({data:e.data,step:"4.1",output:"all"}),e):(d.isFunction(a)&&a(),i.cancellationToken.cancel(),e)}function r(e){var i=e.callType;return"page_info"!==i&&"visualized_track"!==i||t.bridge.hasVisualModeBridge()?"sensorsdata_get_app_visual_config"===i?d.isObject(window.SensorsData_APP_New_H5_Bridge)&&window.SensorsData_APP_New_H5_Bridge[i]:n()&&n().postMessage(JSON.stringify(e)):null}var s,n,t,d,o,_={init:function(e){t=e,d=t&&t._,o=t&&t.log||console&&console.log||function(){},i()},handleCommand:r};return e(_,"IOSBridge","sdkAfterInitPara"),_}();