function addProperties(e,t){if("track"!==e.type)return e;var i=t.sd,r=i._,s=i.saEvent.check,o=r.extend2Lev({properties:{}},e),n=t.currentProps,p=o.properties,c=o.event,g={};return r.each(n,function(e){if(r.isObject(e))r.indexOf(e.events,c)>-1&&s({properties:e.properties})&&(g=r.extend(g,e.properties));else if(r.isFunction(e)){var t=e({event:c,properties:p,data:o});r.isObject(t)&&!r.isEmptyObject(t)&&s({properties:t})&&(g=r.extend(g,t))}}),e.properties=r.extend(p,g),e}function DataStageImpl(e){var t=this;this.sd=e.sd,this.currentProps=e.customRegister,this.interceptor={addCustomProps:{priority:0,entry:function(e){return addProperties(e,t),e}}}}function registerPropertiesFeature(e){this.dataStage=new DataStageImpl(e)}function RegisterProperties(){this.sd=null,this.log=window.console&&window.console.log||function(){},this.customRegister=[]}DataStageImpl.prototype.init=function(){},RegisterProperties.prototype.init=function(e){e?(this.sd=e,this._=e._,this.log=e.log,e.registerFeature(new registerPropertiesFeature(this))):this.log("\u795e\u7b56JS SDK\u672a\u6210\u529f\u5f15\u5165")},RegisterProperties.prototype.register=function(e){this.sd?this._.isObject(e)&&this._.isArray(e.events)&&e.events.length>0&&this._.isObject(e.properties)&&!this._.isEmptyObject(e.properties)?this.customRegister.push(e):this.log("RegisterProperties: register \u53c2\u6570\u9519\u8bef"):this.log("\u795e\u7b56JS SDK\u672a\u6210\u529f\u5f15\u5165")},RegisterProperties.prototype.hookRegister=function(e){this.sd?this._.isFunction(e)?this.customRegister.push(e):this.log("RegisterProperties: hookRegister \u53c2\u6570\u9519\u8bef"):this.log("\u795e\u7b56JS SDK\u672a\u6210\u529f\u5f15\u5165")},RegisterProperties.prototype.name="RegisterProperties";var instance=new RegisterProperties;export default instance;