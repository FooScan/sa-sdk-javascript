(window.SensorsDataWebJSSDKPlugin=window.SensorsDataWebJSSDKPlugin||{}).IOSObsoleteBridge=function(){"use strict";function e(e,r,t){var n=e.init;return r&&(e.name=r),e.init=function(r,i){function a(){n.call(e,r,i)}return r.readyState&&r.readyState.state>=3||!r.on?a():void r.on(t,a)},e}function r(){if(a&&!a.bridge.activeBridge&&t()){if(a.bridge.activeBridge=u,a.bridge.bridge_info={touch_app_bridge:!0,platform:"ios",verify_success:n()?"success":"fail"},!a.para.app_js_bridge)return void o("app_js_bridge is not configured, data will not be sent by iOS obsolete bridge.");a.registerInterceptor("sendStage",{send:{priority:0,entry:i}}),o("IOS obsolete bridge inits succeed.")}}function t(){return(/sensors-verify/.test(navigator.userAgent)||/sa-sdk-ios/.test(navigator.userAgent))&&!window.MSStream}function n(){if(/sensors-verify/.test(navigator.userAgent)){var e=navigator.userAgent.match(/sensors-verify\/([^\s]+)/);if(e&&e[0]&&"string"==typeof e[1]&&2===e[1].split("?").length){e=e[1].split("?");var r=null,t=null;try{r=s.URL(a.para.server_url).hostname,t=s.URL(a.para.server_url).searchParams.get("project")||"default"}catch(n){a.log(n)}return!(!r||r!==e[0]||!t||t!==e[1])}return!1}return!!/sa-sdk-ios/.test(navigator.userAgent)}function i(e,r){function t(e){var r=JSON.stringify(s.extend({server_url:a.para.server_url},e));return r=r.replace(/\r\n/g,""),r=encodeURIComponent(r),"sensorsanalytics://trackEvent?event="+r}if(a.para.app_js_bridge.is_mui)return e;var n=e.callback;if(a.bridge.bridge_info.verify_success){var i=document.createElement("iframe"),o=t(e.data);return i.setAttribute("src",o),document.documentElement.appendChild(i),i.parentNode.removeChild(i),i=null,s.isFunction(n)&&n(),r.cancellationToken.cancel(),!0}return a.para.app_js_bridge.is_send?(a.debug.apph5({data:e.data,step:"3.2",output:"all"}),e):(s.isFunction(n)&&n(),r.cancellationToken.cancel(),e)}var a,s,o,u={init:function(e){a=e,s=a&&a._,o=a&&a.log||console&&console.log||function(){},r()}};return e(u,"IOSObsoleteBridge","sdkAfterInitPara"),u}();